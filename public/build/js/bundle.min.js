let pagina=1;const cita={usuario:"",nombre:"",fecha:"",hora:"",pagar:"0",servicios:[]},expresion={nombre:/^[a-zA-ZÀ-ÿ\s]{4,40}$/};function iniciarApp(){mostrarServicios(),mostrarSeccion(),cambiarSeccion(),paginaSiguiente(),paginaAnterior(),botonesPaginador(),nombreCliente(),fechaCliente(),horaCliente(),deshabilitarFechaAnterior()}document.addEventListener("DOMContentLoaded",(function(){try{iniciarApp()}catch(e){}}));const currency=function(e){return new Intl.NumberFormat("es-co",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e)};async function mostrarServicios(){try{const e="http://localhost:4000/api/servicios",t=await fetch(e);(await t.json()).forEach(e=>{const{id:t,nombre:o,precio:n}=e,a=document.createElement("P");a.textContent=o,a.classList.add("nombre-servicio");const r=document.createElement("P");r.textContent="$"+n,r.textContent=currency(n),r.classList.add("precio-servicio");const c=document.createElement("DIV");c.classList.add("servicio"),c.dataset.idServicio=t,c.onclick=function(){seleccionarServicio(e)},c.appendChild(a),c.appendChild(r),document.querySelector("#servicio").appendChild(c)})}catch(e){console.log(e)}}function seleccionarServicio(e){const{id:t}=e,{servicios:o}=cita,n=document.querySelector(`[data-id-servicio="${t}"]`);o.some(e=>e.id===t)?(cita.servicios=o.filter(e=>e.id!==t),n.classList.remove("seleccionado")):(cita.servicios=[...o,e],n.classList.add("seleccionado"))}function nombreCliente(){cita.nombre=document.querySelector("#Nombre").value,cita.usuario=document.querySelector("#usuario").value}function deshabilitarFechaAnterior(){const e=document.getElementById("fecha"),t=new Date,o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),r=`${o}-${n<10?"0"+n:n}-${a<10?"0"+a:a}`;e.min=r}function fechaCliente(){const e=document.querySelector("#fecha");var t=new Date,o=t.getMonth()+1,n=t.getDate(),a=t.getFullYear();const r=t.getUTCDay();n<10&&(n="0"+n),o<10&&(o="0"+o),[6,0].includes(r)||(e.value=a+"-"+o+"-"+n,cita.fecha=e.value),e.addEventListener("input",(function(t){const o=new Date(t.target.value).getUTCDay();[6,0].includes(o)?(t.preventDefault(),e.value="",mostrar_Alerta("No hay servicio para el día seleccionado.")):cita.fecha=document.querySelector("#fecha").value}))}function horaCliente(){const e=document.querySelector("#hora");e.addEventListener("input",t=>{const o=t.target.value.split(":");o[0]<8||o[0]>18?(t.preventDefault(),e.value="",mostrar_Alerta("No hay servicio disponible a la hora seleccionada.")):cita.hora=document.querySelector("#hora").value})}function mostrar_Alerta(e,t=null){const o=document.querySelector(".contenedor-error");if(o){o.remove();const t=document.createElement("DIV");t.classList.add("contenedor-error");const n=document.createElement("DIV");n.classList.add("alerta"),n.classList.add("error");const a=document.createElement("P");a.textContent=e,n.appendChild(a),t.appendChild(n),document.querySelector(".app").appendChild(t),setTimeout((function(){t.remove()}),7e3)}else{const t=document.createElement("DIV");t.classList.add("contenedor-error");const o=document.createElement("DIV");o.classList.add("alerta"),o.classList.add("error");const n=document.createElement("P");n.textContent=e,o.appendChild(n),t.appendChild(o),document.querySelector(".app").appendChild(t),setTimeout((function(){t.remove()}),7e3)}}function mostrarResumen(){const{nombre:e,fecha:t,hora:o,servicios:n}=cita,a=document.querySelector(".contenido-resumen");for(;a.firstChild;)a.removeChild(a.firstChild);if(Object.values(cita).includes("")||0===n.length){const e=document.createElement("P");return e.textContent="Falta completar campos o seleccionar servicios",e.classList.add("invalidar-cita"),void a.appendChild(e)}const r=document.querySelector(".contenedor-error");r&&r.remove();const c=document.createElement("DIV");c.classList.add("resumen");const s=document.createElement("H3");s.textContent="Datos de Reserva";const i=document.createElement("P");i.innerHTML='<span class="negrita">Nombre:</span> '+e;const l=new Date(t),d=l.getMonth(),u=l.getDate()+2,m=l.getFullYear(),p=new Date(Date.UTC(m,d,u)).toLocaleDateString("es-CO",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),A=o.split(":");var f="";let v;A[0]<12?f="a.m.":A[0]>11&&(f="p.m."),v=A>12?A[0]-12:A[0];const h=document.createElement("P");h.innerHTML='<span class="negrita">Fecha:</span> '+p;const g=document.createElement("P");g.innerHTML=`<span class="negrita">Hora:</span> ${v}:${A[1]} ${f}`;const y=document.createElement("DIV");y.classList.add("resumen-servicios");const b=document.createElement("H3");b.textContent="Servicios",y.appendChild(b);let L=0;n.forEach(e=>{const{nombre:t,precio:o}=e,n=document.createElement("DIV");n.classList.add("contenedor-servicio");const a=document.createElement("P");a.textContent=t;const r=document.createElement("P");r.textContent=currency(o),r.classList.add("precio");const c=Number(o);L+=c,n.appendChild(a),n.appendChild(r),y.appendChild(n)}),a.appendChild(c),c.appendChild(s),c.appendChild(i),c.appendChild(h),c.appendChild(g),c.appendChild(y);const C=document.createElement("H3");C.classList.add("total"),cita.pagar=L,C.innerHTML=`Total: <span>${currency(L)}</span>`,c.appendChild(C);const S=document.createElement("BUTTON");S.classList.add("btn-reservar"),S.textContent="Reservar",S.onclick=reservarCita,a.appendChild(S),console.log(cita)}async function reservarCita(){const{usuario:e,fecha:t,hora:o,servicios:n,pagar:a}=cita,r=n.map(e=>e.id),c=new FormData;c.append("usuario",e),c.append("fecha",t),c.append("hora",o),c.append("servicios",r),c.append("total",a);try{const e="http://localhost:4000/api/citas",t=await fetch(e,{method:"POST",body:c});(await t.json()).resultado&&Swal.fire({position:"center",icon:"success",title:"Reserva Creada",text:"Tu reserva se creo con correctamente",button:"OK"}).then(()=>{window.location.reload()})}catch(e){Swal.fire({icon:"error",title:"Error",text:"No pudimos guardar tu reserva, intenta nuevamente más tarde"}).then(()=>{window.location.reload()})}}function mostrarSeccion(){const e=document.querySelector(".mostrar-seccion");e&&e.classList.remove("mostrar-seccion");document.querySelector("#paso-"+pagina).classList.add("mostrar-seccion");const t=document.querySelector(".actual");t&&t.classList.remove("actual");document.querySelector(`[data-paso="${pagina}"]`).classList.add("actual")}function cambiarSeccion(){document.querySelectorAll(".tabs button").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),pagina=parseInt(e.target.dataset.paso),mostrarSeccion(),botonesPaginador()})})}function paginaSiguiente(){document.querySelector("#siguiente").addEventListener("click",()=>{pagina++,botonesPaginador()})}function paginaAnterior(){document.querySelector("#anterior").addEventListener("click",()=>{pagina--,botonesPaginador()})}function botonesPaginador(){const e=document.querySelector("#siguiente"),t=document.querySelector("#anterior");1===pagina?(t.classList.add("ocultar"),e.classList.remove("ocultar")):3===pagina?(t.classList.remove("ocultar"),e.classList.add("ocultar"),mostrarResumen()):(t.classList.remove("ocultar"),e.classList.remove("ocultar")),mostrarSeccion()}function iniciarApp(){buscarPorFecha()}function buscarPorFecha(){document.querySelector("#fecha").addEventListener("input",(function(e){const t=e.target.value;console.log(t),alert(t)}))}
/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-webp-setclasses !*/document.addEventListener("DOMContentLoaded",(function(){iniciarApp()})),function(e,t,o){function n(e,t){return typeof e===t}function a(e){var t=u.className,o=l._config.classPrefix||"";if(m&&(t=t.baseVal),l._config.enableJSClass){var n=new RegExp("(^|\\s)"+o+"no-js(\\s|$)");t=t.replace(n,"$1"+o+"js$2")}l._config.enableClasses&&(t+=" "+o+e.join(" "+o),m?u.className.baseVal=t:u.className=t)}function r(e,t){if("object"==typeof e)for(var o in e)d(e,o)&&r(o,e[o]);else{var n=(e=e.toLowerCase()).split("."),c=l[n[0]];if(2==n.length&&(c=c[n[1]]),void 0!==c)return l;t="function"==typeof t?t():t,1==n.length?l[n[0]]=t:(!l[n[0]]||l[n[0]]instanceof Boolean||(l[n[0]]=new Boolean(l[n[0]])),l[n[0]][n[1]]=t),a([(t&&0!=t?"":"no-")+n.join("-")]),l._trigger(e,t)}return l}var c=[],s=[],i={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var o=this;setTimeout((function(){t(o[e])}),0)},addTest:function(e,t,o){s.push({name:e,fn:t,options:o})},addAsyncTest:function(e){s.push({name:null,fn:e})}},l=function(){};l.prototype=i,l=new l;var d,u=t.documentElement,m="svg"===u.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;d=n(e,"undefined")||n(e.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(t,o){return e.call(t,o)}}(),i._l={},i.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),l.hasOwnProperty(e)&&setTimeout((function(){l._trigger(e,l[e])}),0)},i._trigger=function(e,t){if(this._l[e]){var o=this._l[e];setTimeout((function(){var e;for(e=0;e<o.length;e++)(0,o[e])(t)}),0),delete this._l[e]}},l._q.push((function(){i.addTest=r})),l.addAsyncTest((function(){function e(e,t,o){function n(t){var n=!(!t||"load"!==t.type)&&1==a.width;r(e,"webp"===e&&n?new Boolean(n):n),o&&o(t)}var a=new Image;a.onerror=n,a.onload=n,a.src=t}var t=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],o=t.shift();e(o.name,o.uri,(function(o){if(o&&"load"===o.type)for(var n=0;n<t.length;n++)e(t[n].name,t[n].uri)}))})),function(){var e,t,o,a,r,i;for(var d in s)if(s.hasOwnProperty(d)){if(e=[],(t=s[d]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(o=0;o<t.options.aliases.length;o++)e.push(t.options.aliases[o].toLowerCase());for(a=n(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(i=e[r].split(".")).length?l[i[0]]=a:(!l[i[0]]||l[i[0]]instanceof Boolean||(l[i[0]]=new Boolean(l[i[0]])),l[i[0]][i[1]]=a),c.push((a?"":"no-")+i.join("-"))}}(),a(c),delete i.addTest,delete i.addAsyncTest;for(var p=0;p<l._q.length;p++)l._q[p]();e.Modernizr=l}(window,document);const expresiones={nombre:/^[a-zA-ZÀ-ÿ\s]{10,40}$/,correo:/^[-\w.%+]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,63}$/i,numero:/^[0-9]{10}$/,"contraseña":/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,mayuscula:/^[A-Z]/,minuscula:/^[a-z]/,numeros:/^[0-9]/,caracteres:/^[.]/},campos={nombre:!1,correo:!1,telefono:!1},datos={nombre:"",correo:"",telefono:""};function headerFijo(){if(document.querySelector(".header")){const e=document.querySelector(".header"),t=document.querySelector(".navegacion-principal");window.addEventListener("scroll",(function(){t.classList.toggle("sticky",window.scrollY>0),e.classList.toggle("sticky",window.scrollY>0)}))}}function carga(){const e=document.getElementById("formulario"),t=document.querySelectorAll(".campos-validacion");try{const e=document.querySelector("#nombre"),t=document.querySelector("#correo"),o=document.querySelector("#telefono");e.addEventListener("input",leerTexto),t.addEventListener("input",leerTexto),o.addEventListener("input",leerTexto)}catch(e){}t.forEach(e=>{e.addEventListener("keyup",validarFormulario),e.addEventListener("blur",validarFormulario),e.addEventListener("keydown",validarFormulario)}),e.onsubmit=function(t){t.preventDefault();const{nombre:o,correo:n,telefono:a}=datos;campos.nombre&&campos.correo&&campos.telefono?(e.reset(),""===o.datos||""===n.datos||""===a.datos?mostrarAlerta("*Todos los campos son obligatorios","error"):mostrarAlerta("Formulario enviado correctamente")):mostrarAlerta("Los campos son obligatorios, o están incorrectos","error")}}function leerTexto(e){try{datos[e.target.id]=e.target.value}catch(e){}}document.addEventListener("DOMContentLoaded",(function(){try{scrollNav(),botonTop(),headerFijo(),carga()}catch(e){}}));const validarFormulario=e=>{switch(e.target.name){case"nombre":validarCampo(expresiones.nombre,e.target,"nombre");break;case"correo":validarCampo(expresiones.correo,e.target,"correo");break;case"telefono":validarCampo(expresiones.numero,e.target,"telefono")}},validarCampo=(e,t,o)=>{const n=document.querySelector(".campo__correcto--"+o),a=document.querySelector(".campo__incorrecto--"+o),r=document.querySelector("#"+o);e.test(t.value)?(a.classList.remove("mensaje-error"),n.classList.add("mensaje-correcto"),campos[o]=!0):(n.classList.remove("mensaje-correcto"),a.classList.add("mensaje-error"),campos[o]=!1),0==r.value.length&&(n.classList.remove("mensaje-correcto"),a.classList.remove("mensaje-error"),campos[o]=!1)};function mostrarAlerta(e,t=null){const o=document.getElementById("formulario"),n=document.createElement("DIV"),a=document.createElement("P");let r;a.textContent=e,n.appendChild(a),o.appendChild(n),t?(n.classList.add("error"),r="error"):(n.classList.add("mensaje"),document.querySelectorAll(".campos-validacion span").forEach(e=>{e.classList.remove("mensaje-correcto")}),r="mensaje"),setTimeout(()=>{n.remove(r)},3e3);document.querySelector(".boton").addEventListener("click",(function(){n.remove()}))}function scrollNav(){document.querySelectorAll(".navegacion-principal a").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();document.querySelector(e.target.attributes.href.value).scrollIntoView({behavior:"smooth"})}))}))}function botonTop(){if(document.querySelector(".boton-Top")){const e=document.querySelector(".boton-Top"),t=document.querySelector(".boton-Top img");window.onscroll=function(){document.documentElement.scrollTop>1e3?e.classList.add("imagen-Top"):e.classList.remove("imagen-Top")},window.onload=function(){t.onclick=function(){window.scrollTo({top:0,behavior:"smooth"})}}}}
//# sourceMappingURL=bundle.js.map
